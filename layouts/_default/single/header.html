{{- $metadata := "full" -}}
{{ if isset .Params "metadata" }}{{ $metadata = .Params.metadata }}{{ else }}{{ with (index site.Params.pages .Type ) }}{{ if isset . "metadata" }}{{ $metadata = (index . "metadata") }}{{ end }}{{ end }}{{ end }}
{{- $supportedStates := slice "full" "original" "none" -}}
{{- if not (in $supportedStates $metadata) }}{{ errorf "layout [_default/single/header.html] - Invalid value for param 'metadata': %s" $metadata }}{{ end }}

{{ $title := .Title }}
{{ if site.Params.main.titleCase }}{{ $title = title $title }}{{ end }}

{{ with $title }}<h1 class="mt-1">{{ . }}</h1>{{ end }}
{{ if ne $metadata "none" }}
    <small class="text-body-secondary text-capitalize">
        {{/* --- LOGIC NGÀY MỚI --- */}}
        {{ if .Lastmod }}
            {{/* Ưu tiên hiển thị Lastmod nếu có */}}
            {{ $lastmodstr := (partial "utilities/date.html" (dict "date" .Lastmod "format" "long")) -}}
            {{ $lastmodstr | i18n "lastModified" }}
        {{ else if .Date }}
            {{/* Nếu không có Lastmod, hiển thị Date */}}
            {{ $datestr := (partial "utilities/date.html" (dict "date" .Date "format" "long")) -}}
            {{ $datestr | i18n "postedOnDate" }}
        {{ end }}
        {{/* --- KẾT THÚC LOGIC NGÀY MỚI --- */}}

        {{/* Thông tin Reading time và Word count giữ nguyên */}}
         • {{ .ReadingTime | lang.FormatNumber 0 }} {{ i18n "minutesShort" }} {{ i18n "read" }} • {{ .WordCount | lang.FormatNumber 0 }} {{ i18n "words" }}
    </small>
{{ end }}

{{/* Đoạn code Tags đã bị xóa khỏi đây */}}

{{ partial "assets/sharing.html" (dict "page" .) }}
<p class="lead mb-4 mt-3">{{ .Description }}</p>